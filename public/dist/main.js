String.prototype.titleCase=function(){return this.split(" ").map(function(t,r){return t.charAt(0).toUpperCase()+t.substr(1)}).join(" ")},String.prototype.replaceAll=function(t,r){var e=new RegExp(t,"g");return this.replace(e,r)};
function ajaxResponse(e){console.log(e.message)}function ajaxCall(e,a,l){$.ajax({url:"/vote?id="+a,type:e,data:l,success:ajaxResponse,failure:ajaxResponse})}function handleDelete(e,a){var l="Are you sure you want to permanently delete this ballot";confirm(l)&&($(e).parent().hide(),ajaxCall("DELETE",a,null))}$(".form-btn input").on("click",function(){var e=$("input[type='radio']:checked").val();ajaxCall("PUT","",{vote:e.replaceAll("-"," ")})});
function updateOptionList(){var t=newOption.titleCase().replaceAll(" ","-"),n="<label><input type='radio' name='option' value='"+t+"'>"+newOption+"</label>",i="<div class='form-btn'>"+$(".form-btn").html()+"</div>";$(".form-btn").hide(),$(".alt-option").html(n).addClass("radio").removeClass("alt-option"),$(".ballot").append(altOptionHTML+i)}var newOption="",altOptionHTML="<div class='radio alt-option'>"+$(".alt-option").html()+"</div>",buttonHTML="<button class='add-option' onclick='updateOptionList()'>Add</button>";$("input[type='radio']").on("click",function(){var t=$(this).parent().text().trim();t!=$(this).val()&&$(this).val(t.replaceAll(" ","-"))}),$(document).on("click",".alt-option input[type='radio']",function(){var t="<input type='text' value=''>"+buttonHTML;$(this).parent().parent().html(t).removeClass("radio")}),$(document).on("keyup","input[type='text']",function(t){newOption=$.trim($(this).val())});
$(document).ready(function(){function t(t){for(var e=["#ff986d","#f47361","#e35056","#cb2f44","#ae112a","#8b0000"],n=[],a=0;n.length<=t;)a>=e.length&&(a=0),n.push(e[a]),a++;return n}!function(){$("#myChart").length&&$.getJSON("/stream",function(e){if(!e.options)return void $(".chart").prepend("<a href='/'><h3>Error loading chart.</h3></a>");var n=Object.keys(e.options),a=document.getElementById("myChart").getContext("2d");new Chart(a,{type:"bar",data:{labels:n,datasets:[{data:n.map(function(t){return e.options[t].votes}),backgroundColor:t(n.length),label:"# of votes"}]}})})}()});